/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */
 apply plugin: 'java'
 
buildscript {
   repositories {
       maven { url "http://repo.maven.apache.org/maven2/" }
   }
   dependencies {
      classpath "io.spring.gradle:dependency-management-plugin:1.0.1.RELEASE"
      classpath 'org.springframework.boot:spring-boot-gradle-plugin:2.0.0.RELEASE'	
   }
   
   configurations {
      compile.exclude group:'ch.qos.logback'
   }
}

subprojects {
	apply plugin: 'java'
   	apply plugin: 'eclipse'
	apply plugin: 'io.spring.dependency-management'	

    
    repositories {
        maven { url "http://repo.maven.apache.org/maven2/" }

    }
    
    apply from: "${rootProject.projectDir}/dependency-management.gradle"
    
    dependencies {
      compile 'org.apache.logging.log4j:log4j-api:2.7'
      compile 'org.apache.logging.log4j:log4j-core:2.7'
      compile 'org.apache.logging.log4j:log4j-slf4j-impl:2.7'
      compile 'org.projectlombok:lombok:1.16.20'

        testCompile 'org.powermock:powermock-api-mockito2'
        testCompile 'org.powermock:powermock-module-junit4'

        testCompile 'junit:junit'
        testCompile 'org.mockito:mockito-core'
        testCompile 'org.hamcrest:hamcrest-all'
   }
}



    def mainProjects = [':Shared',':Parser',':Generator',':Simulator',':TrafficSimulatorService']
    
	task oneJar( type: Jar , dependsOn: mainProjects.collect{ it+":compileJava"}) {
	manifest {
        attributes 'Main-Class': 'trafficsimulator.server.TrafficSimulator'
    }
		baseName = 'ts'
	from files(mainProjects.collect{ project(it).sourceSets.main.output })
	}
